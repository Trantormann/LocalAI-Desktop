# AI Agent 功能使用说明

## 🎯 什么是 AI Agent 模式？

AI Agent 模式让 AI 能够理解自然语言指令，并自动执行系统操作。无需手动点击按钮，只需告诉 AI 您想做什么。

---

## ✨ 功能特性

### **支持的操作**

1. **打开应用程序**
   - 记事本（Notepad）
   - 计算器（Calculator）
   - 画图（Paint）
   - 文件资源管理器（Explorer）
   - 任务管理器（Task Manager）
   - 命令提示符（CMD）
   - PowerShell
   - 控制面板（Control Panel）

2. **屏幕截图**
   - 截取当前屏幕
   - 用于分析界面或查看内容

3. **系统信息**
   - 获取 CPU 使用率
   - 查看内存使用情况
   - 磁盘空间统计

---

## 💬 使用示例

### **示例 1：打开应用程序**

```
用户：帮我打开记事本
AI：好的，正在为您打开记事本...
    [执行操作]
    记事本已打开！

用户：打开文件资源管理器
AI：[执行操作] 文件资源管理器已打开。

用户：启动计算器
AI：[执行操作] 计算器已启动。
```

### **示例 2：屏幕截图**

```
用户：截个图看看
AI：好的，正在截取屏幕...
    [显示截图]

用户：帮我截个屏
AI：[执行截图] 已为您截取当前屏幕。
```

### **示例 3：系统信息**

```
用户：查看一下系统状态
AI：正在获取系统信息...
    当前系统状态：
    - CPU 使用率：25%
    - 内存使用：8.5GB / 16GB
    - 磁盘空间：剩余 250GB

用户：电脑卡吗
AI：[获取系统信息] 当前 CPU 使用率 15%，内存占用正常，系统运行流畅。
```

### **示例 4：复合操作**

```
用户：打开记事本，我要记录一些东西
AI：[执行操作] 记事本已打开，您可以开始记录了。

用户：打开任务管理器看看有什么程序在运行
AI：[执行操作] 任务管理器已打开，您可以查看正在运行的程序。
```

---

## ⚙️ 如何启用/禁用

### **启用 Agent 模式**

1. 点击侧边栏的 **"设置"** 按钮
2. 在 **"安全设置"** 部分找到 **"启用 AI Agent 模式"**
3. 打开开关 ✅
4. 点击 **"保存设置"**

### **禁用 Agent 模式**

1. 进入设置界面
2. 关闭 **"启用 AI Agent 模式"** 开关 ❌
3. 保存设置

**注意：** 禁用后，AI 将无法自动执行系统操作，需要手动点击按钮。

---

## 🔒 安全机制

### **白名单系统**

- 只允许执行预定义的安全应用程序
- 不支持任意命令执行
- 所有操作都有日志记录

### **可控开关**

- 可以随时启用/禁用 Agent 模式
- 可以单独控制系统控制权限
- 完全透明，用户可见所有操作

### **操作日志**

所有 Agent 操作都会记录在：
```
logs/localai_YYYYMMDD.log
```

---

## 🎨 高级用法

### **自然语言理解**

AI 能理解多种表达方式：

**打开记事本：**
- "帮我打开记事本"
- "启动 notepad"
- "打开文本编辑器"
- "我想写点东西"

**截图：**
- "截个图"
- "截屏"
- "帮我截图"
- "看看屏幕"

### **上下文理解**

AI 能理解对话上下文：

```
用户：打开记事本
AI：[执行] 记事本已打开

用户：再打开一个计算器
AI：[理解"再"的含义] 计算器已打开
```

---

## 🚀 技术原理

### **Function Calling**

使用 Ollama 的 Function Calling 功能：

1. **用户输入** → AI 理解意图
2. **决策** → AI 判断需要执行哪个工具
3. **执行** → 调用系统控制模块
4. **反馈** → 返回执行结果

### **支持的模型**

- ✅ **qwen3:8b** - 推荐，原生支持 Function Calling
- ✅ **qwen3:14b** - 更强的理解能力
- ✅ **qwen2.5:7b** - 兼容支持
- ⚠️ 其他模型可能支持有限

---

## 📝 注意事项

1. **首次使用**
   - 确保已启用 "允许系统控制"
   - 确保已启用 "AI Agent 模式"
   - 建议使用 qwen3:8b 或更高版本

2. **响应时间**
   - Agent 模式需要模型思考，可能比普通对话慢 2-3 秒
   - 这是正常现象

3. **错误处理**
   - 如果操作失败，AI 会告诉您原因
   - 检查 Ollama 是否正常运行
   - 查看日志文件获取详细信息

4. **隐私安全**
   - 所有操作都在本地执行
   - 不会上传任何数据到云端
   - 完全离线可用

---

## 🆘 常见问题

### **Q: AI 不执行我的指令？**
A: 检查以下几点：
- 是否启用了 "AI Agent 模式"？
- 是否启用了 "允许系统控制"？
- 使用的模型是否支持 Function Calling？

### **Q: 指令执行很慢？**
A: Agent 模式需要模型推理，比普通对话慢是正常的。使用更快的模型（如 qwen3:4b）可以提速。

### **Q: 想执行更多操作？**
A: 目前仅支持白名单中的安全操作。后续版本会扩展更多功能。

### **Q: 如何查看执行日志？**
A: 打开 `logs/localai_YYYYMMDD.log` 文件，搜索 `[Agent]` 关键词。

---

## 🎉 开始使用

1. **启动服务**
   ```batch
   start.bat
   ```

2. **打开 WebUI**
   ```
   http://127.0.0.1:7860
   ```

3. **开始对话**
   ```
   "你好，帮我打开记事本"
   ```

4. **享受智能助手！** 🚀

---

**版本：** 1.0  
**最后更新：** 2026-02-04  
**支持模型：** Qwen3, Qwen2.5 系列
